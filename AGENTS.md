# Repository Guidelines

## Project Structure & Module Organization
- `src/` holds the TypeScript service and RPA page objects. Entry point is `src/server.ts`; session/browser utilities live in `src/lib/`; EPARK page flows live in `src/pages/`.
- `test/` contains Node-based integration scripts (for example `test/api-test.cjs`) plus `test/screenshots/` output.
- `docs/` includes the RPA spec (`docs/RPA_SPEC.md`).
- `scripts/` provides Docker lifecycle helpers (`scripts/start.sh`, `scripts/stop.sh`, etc.).
- `dist/` is the TypeScript build output (generated by `tsc`).
- `screenshots/` stores runtime screenshots captured by the service.

## Build, Test, and Development Commands
- `npm install` installs dependencies; `postinstall` builds `@smartcall/rpa-sdk`.
- `npm run dev` starts a watch mode server using `ts-node` and `.env`.
- `npm run start` runs the server directly from TypeScript (no build step).
- `npm run build` compiles to `dist/`.
- `npm run lint` runs ESLint on `src/`.
- `npm run import` runs reservation import via `src/import-reservations.ts`.
- `node test/api-test.cjs` runs end-to-end API checks against a running server.
- `npm run test:concurrent` validates concurrency behavior.
- Docker: `./scripts/start.sh`, `./scripts/stop.sh`, `./scripts/restart.sh`, `./scripts/status.sh`, `./scripts/logs.sh -f`.

## Coding Style & Naming Conventions
- TypeScript ESM modules with 2-space indentation and semicolons.
- Classes use PascalCase; functions/variables use camelCase.
- Filenames mirror class responsibilities (for example `BrowserSessionManager.ts`, `LoginPage.ts`).
- Keep API headers consistent with `X-RPA-*` naming in server routes and tests.

## Testing Guidelines
- Tests are runnable scripts under `test/`, not a formal framework.
- Keep tests self-contained and log failures clearly; use `test/screenshots/` for evidence when `X-RPA-Test-Mode` is enabled.
- Run `node test/api-test.cjs` with `.env` set and the server already running.

## Commit & Pull Request Guidelines
- Follow Conventional Commit prefixes seen in history: `feat:`, `fix:`, `refactor:` plus a short summary.
- PRs should include: a concise description, how to verify (commands run), and screenshots/logs when RPA UI behavior changes.
- Note any `.env` or configuration changes explicitly in the PR description.

## Security & Configuration Tips
- Store credentials in `.env` (see `.env.example`); never commit secrets.
- API requests must include `X-RPA-Login-Id`, `X-RPA-Login-Password`, and `X-RPA-Shop-Id` headers.
